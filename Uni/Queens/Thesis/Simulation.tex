\chapter{Simulation}

As P--ONE has only deployed the Pathfinder missions thus far, including STRAW and STRAWb, the data used in this thesis is primarily simulated. In particular, the data needs to be usable to test and build a reconstruction algorthim for muon--neutrinos. This means simulating muon tracks. For this reason, we lightly cover the simulation process used to produce data including the pre--existing IceCube Framework, Simulating Neutrinos, Simulating Muons and the Detector Response. 

\section{IceCube Framework}

The software framework already exists from IceCube, and in order to minimize the amount of new code needed to simulate P--ONE it is simplest to use the IceCube software. In particular, the software documentation is readily available \cite{icetray} and referred to as IceTray. This is meant to be a full framework capable of simulating, reconstructing and analysis all in one \cite{icetray}. For the purposes of P--ONE, we wish to only use the simulation subset of the framework as it is primarily made using open--source software, and hence can avoid potential proprietary issues.

The bulk of the code is written in C++ with the goal of being modular. This means that rather than writing scripts that call functions or classes that are pre--existing, the code is designed so that there is a single steering script that calls modules to run tasks including the simulation of muons or neutrinos, and including geometry files. Modules can be added by users as well to then be included in the steering scripts. The code has also been wrapped using Python so that modules can be reached via python scripts, and hence steering scripts can be written in Python. For this reason, Python is the language of choice for the purposes of this work.

\section{Simulating Neutrinos}

The sofware used to generate neutrinos is the very aptly named Neutrino--Generator (NuGen) \cite{icetray}. This is code written in IceTray based off of the All Neutrino Interaction Generator (ANIS), a high energy neutrino generator used for neutrino telescopes. NuGen has the capabilities of preparing and injecting a neutrino and interacting along the way if they so happen, and then forcing an interaction in the detector. NuGen can also produce secondaries. However, NuGen does not propogate photons nor charged leptons. This is saved for PROPOSAL and CLSim, where the former is used to propogate charged leptons and the latter is used to produce and propogate photons in a parallel manner (if using GPUs). 

\section{Simulating Muons}

The module used to generate muons is the Muon Gun that exists in GEANT4. This can be used to inject muons based on some sampling surface dependent upon a given flux model \cite{icetray}. Muon Gun is versatile as it can be easily modified to produce muons using a variety of sampling surfaces, and can even be modified to be energy dependent \cite{icetray}.

Do we talk about Muon Gun or Cosmic Muons? Currently only Cosmic Muons are being used but both could be used.

\section{Detector Response}

The choice of geometry is incredibly important, as varying the position and number of detectors can, as one would expect, result in large changes in the performance of the detecor (\textbf{WHERE TO CITE THIS FROM?}). The current proposed first stage of P--ONE is to be a pair of nested circles with the inner containing three strings and the outer containing 7 \cite{pone}, as we can see in Figure \ref{fig:pone_geo}. The simulated geometry is based off of this first design and held in a ``.gcd'' file which is used by IceTray \cite{icetray}. \textbf{GET IMAGE OF GCD HERE SOMEHOW}. If we wish to see how the potential detector performance is affected by varying the geometry, we can change this geometry file and measure parameters such as the effective area to see how well it compares.

One of the most useful and widely used methods of measuring a neutrino detectors performance at a glance is the effective area. For a given particle of interest with some flux, the effective area is defined as the area of the detector scaled by the efficiency of the detector in measuring this particle \cite{2010icecube}. Another way of phrasing this is that the effective area is that which detects perfectly the particles entering it for a given number of detections. Computing the effective area is non-trivial, as it is particle, flavour, energy, and direction dependent. 

This has to include the detector geometry (GCD) files, the DOMs, and efficiency...?

